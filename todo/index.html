<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Algrow Learning's Todo App | sign-in</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <header>
      <h1>Algrow Learning</h1>
    </header>

    <main>
      <h2>Sign In.</h2>
      <section>
        <input id="user-name" type="text" placeholder="User Name" /><br />
        <input id="password" type="password" placeholder="Password" /><br />
        <button id="sign-in-btn">Login</button>
      </section>
      <p>Don't have an account? <a href="./signUp.html">Sign Up</a></p>
    </main>

    <!--  -->
    <script>
      const userName = document.querySelector("#user-name");
      const userPassword = document.querySelector("#password");
      const signInBtn = document.querySelector("#sign-in-btn");
      document.onreadystatechange = function () {
        if (document.readyState !== "complete") {
          if (localStorage.getItem("livelabtoken")) {
            window.open("/main.html", "_self");
          }
        }
      };

      signInBtn.addEventListener("click", function () {
        fetch("/login", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            userName: userName.value,
            password: userPassword.value,
          }),
        })
          .then((res) => res.json())
          .then((data) => {
            if (data.status == "true") {
              var token = data.token;
              // console.log(data.status);
              localStorage.setItem("livelabtoken", token);
              window.open("/main.html", "_self");
            } else {
              alert(data.message);
            }
          });

        // if (userID.value === user.id && userPassword.value === user.password) {
        //   window.open("./main.html", "_self");
        // } else alert("Wrong Password. Please try again!");
      });
    </script>
  </body>
</html>
